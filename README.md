# sohappy

CLI ç»ˆç«¯ç©¿é€åŒæ­¥å·¥å…· - ç±»ä¼¼ Happy Coderï¼ŒåŸºäº tmux å®ç°ï¼Œæ”¯æŒ E2E åŠ å¯†

## ç‰¹æ€§

- ğŸ”’ **ç«¯åˆ°ç«¯åŠ å¯†** - ä½¿ç”¨ NaCl (X25519 + XSalsa20-Poly1305)
- ğŸ“± **QR ç é…å¯¹** - æ‰«æå³å¯è¿æ¥
- ğŸ–¥ï¸ **å®æ—¶åŒæ­¥** - tmux è¾“å‡ºå®æ—¶æ¨é€åˆ°å®¢æˆ·ç«¯
- âŒ¨ï¸ **è¿œç¨‹è¾“å…¥** - é€šè¿‡ Web ç•Œé¢å‘é€è¾“å…¥åˆ° tmux
- ğŸŒ **æœåŠ¡å™¨é€ä¼ ** - æœåŠ¡å™¨æ— æ³•è§£å¯†å†…å®¹

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡å™¨

```bash
npm run dev:server
```

### 2. å¯åŠ¨ Web å®¢æˆ·ç«¯ï¼ˆå¦ä¸€ä¸ªç»ˆç«¯ï¼‰

```bash
npm run dev:web
```

### 3. åˆ›å»º tmux ä¼šè¯å¹¶å¯åŠ¨ CLIï¼ˆç¬¬ä¸‰ä¸ªç»ˆç«¯ï¼‰

```bash
# åˆ›å»ºæµ‹è¯•ç”¨ tmux ä¼šè¯
tmux new-session -d -s test

# å¯åŠ¨ CLI é‡‡é›†ï¼ˆåŠ å¯†æ¨¡å¼ï¼‰
npm run dev:cli -- test

# æˆ–è€…ä¸åŠ å¯†æ¨¡å¼
npm run dev:cli -- test --no-encrypt
```

### 4. è¿æ¥å®¢æˆ·ç«¯

CLI å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š
- è¿æ¥ URL
- QR ç ï¼ˆå¯æ‰«æï¼‰

è®¿é—® http://localhost:5173ï¼Œè¾“å…¥ä¼šè¯åæˆ–ç›´æ¥ç”¨æ˜¾ç¤ºçš„ URLï¼Œç‚¹å‡» Connectã€‚

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   tmux      â”‚ â”€â”€â”€â”€â†’ â”‚   CLI       â”‚ â”€â”€â”€â”€â†’ â”‚  Server     â”‚
â”‚   (shell)   â”‚ â†â”€â”€â”€â”€ â”‚  åŠ å¯†+é‡‡é›†   â”‚ â†â”€â”€â”€â”€ â”‚ (å¯†æ–‡è½¬å‘)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            ğŸ”’                     â”‚
                      E2E Encrypted                â†“
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚  Web Client â”‚
                                            â”‚   è§£å¯†+æ˜¾ç¤º  â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠ å¯†æµç¨‹ï¼š**
1. CLI ç”Ÿæˆ X25519 å¯†é’¥å¯¹
2. Web Client è¿æ¥æ—¶ä¹Ÿç”Ÿæˆå¯†é’¥å¯¹
3. åŒæ–¹äº¤æ¢å…¬é’¥ï¼Œè®¡ç®—å…±äº«å¯†é’¥
4. æ‰€æœ‰é€šä¿¡ä½¿ç”¨ XSalsa20-Poly1305 åŠ å¯†
5. æœåŠ¡å™¨åªèƒ½çœ‹åˆ°å¯†æ–‡ï¼Œæ— æ³•è§£å¯†

## ç›®å½•ç»“æ„

```
packages/
â”œâ”€â”€ cli/          # tmux é‡‡é›† + åŠ å¯† + WebSocket å®¢æˆ·ç«¯
â”œâ”€â”€ server/       # WebSocket æœåŠ¡å™¨ï¼ˆå¯†æ–‡é€ä¼ ï¼‰
â”œâ”€â”€ crypto/       # å…±äº«åŠ å¯†åº“
â””â”€â”€ web-client/   # æµè§ˆå™¨ç«¯å®¢æˆ·ç«¯ï¼ˆè§£å¯† + xterm.jsï¼‰
```

## å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼
npm run dev:server   # å¯åŠ¨æœåŠ¡å™¨
npm run dev:web      # å¯åŠ¨ Web å®¢æˆ·ç«¯
npm run dev:cli      # å¯åŠ¨ CLI

# æ„å»º
npm run build
```

## éƒ¨ç½²

### Docker éƒ¨ç½²æœåŠ¡å™¨

æœ¬é¡¹ç›®æ”¯æŒä½¿ç”¨ Docker éƒ¨ç½²æœåŠ¡å™¨ç«¯ï¼ˆ@sohappy/serverï¼‰ã€‚ä½ éœ€è¦å°†æ•´ä¸ªé¡¹ç›®ä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚

**1. æ„å»ºé•œåƒ**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
docker build -t sohappy-server -f packages/server/Dockerfile .
```

**2. è¿è¡Œå®¹å™¨**
```bash
docker run -d \
  --name sohappy-server \
  -p 3010:3010 \
  --restart unless-stopped \
  sohappy-server
```

æœåŠ¡å™¨å°†åœ¨ 3010 ç«¯å£å¯åŠ¨ã€‚

### åˆ†å¸ƒå¼éƒ¨ç½²é…ç½®

å¦‚æœä½ å°† Webã€Server å’Œ CLI åˆ†åˆ«éƒ¨ç½²åœ¨ä¸åŒæœºå™¨ä¸Šï¼Œè¯·ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®ï¼š

**Server (æœåŠ¡å™¨)**
- éƒ¨ç½²å¹¶è¿è¡Œ Docker å®¹å™¨

**Web (å‰ç«¯)**
- æ„å»ºæ—¶æŒ‡å®šæœåŠ¡å™¨åœ°å€ï¼š
```bash
VITE_SERVER_URL=http://your-server-ip:3010 npm run build
```

**CLI (æœ¬åœ°)**
- è¿è¡Œæ—¶æŒ‡å®šæœåŠ¡å™¨å’Œå‰ç«¯åœ°å€ï¼š
```bash
export SOHAPPY_SERVER_URL=http://your-server-ip:3010
export SOHAPPY_WEB_URL=http://your-web-domain.com

sohappy <session-name>
```
